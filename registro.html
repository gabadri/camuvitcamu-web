document.addEventListener('DOMContentLoaded', function() {

  // 1) Toggle mobile menu
  const navToggle = document.getElementById('navToggle');
  const navLinks = document.getElementById('navLinks');

  if (navToggle && navLinks) {
    navToggle.addEventListener('click', () => {
      navLinks.classList.toggle('active');
    });

    // close menu when clicking a link (mobile)
    navLinks.addEventListener('click', (e) => {
      if (e.target.tagName === 'A') navLinks.classList.remove('active');
    });
  }

  // 2) Year in footer
  const yearEl = document.getElementById('year');
  if (yearEl) yearEl.textContent = new Date().getFullYear();

  // 3) Contact form submit (simple)
  const form = document.getElementById('contactForm');
  if (form) {
    form.addEventListener('submit', (e) => {
      e.preventDefault();
      alert('Gracias por contactarnos. Te responderemos pronto.');
      form.reset();
    });
  }

  // 4) Registro de candidatos con Google Apps Script
  const registroForm = document.getElementById('registroForm');
  if (registroForm) {
    registroForm.addEventListener('submit', function(e) {
      e.preventDefault();

      // Extraer valores del formulario
      const data = {
        dni: document.getElementById('dni').value,
        nombre: document.getElementById('nombre').value,
        email: document.getElementById('email').value
      };

      // URL de tu Web App de Google Apps Script (reemplaza con la tuya publicada)
      const scriptURL = "https://script.google.com/u/0/home/projects/199J6nhytqAtDpKmKWXD1FqZQ-J9aoAgdx7LThBV1vO7NLKtoFyDUAnI5/edit";

      fetch(scriptURL, {
        method: "POST",
        mode: "no-cors", // importante para evitar bloqueos
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(data)
      })
      .then(() => {
        alert("Registro exitoso. Revisa tu correo para tu clave de acceso.");
        registroForm.reset();
      })
      .catch(error => {
        console.error("Error al registrar:", error);
        alert("OcurriÃ³ un error. Intenta de nuevo.");
      });
    });
  }

  // 5) Simple scroll reveal using IntersectionObserver
  const reveals = document.querySelectorAll('.reveal');
  if ('IntersectionObserver' in window && reveals.length) {
    const io = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('active');
          io.unobserve(entry.target);
        }
      });
    }, { threshold: 0.12 });
    reveals.forEach(el => io.observe(el));
  } else {
    // fallback: show all
    reveals.forEach(el => el.classList.add('active'));
  }

});
